<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link th:href="@{/webjars/bootstrap/5.3.8/css/bootstrap.min.css}"
	rel="stylesheet" />
<script th:src="@{/webjars/bootstrap/5.3.8/js/bootstrap.bundle.min.js}"
	defer></script>
<title>Habit Entries</title>
</head>
<body class="container mt-5">
	<h1 class="mb-4">Habit Entries</h1>
	<h2 class="mt-5">Select Habit</h2>
	<form action="#" th:action="@{/last-done-habit-entries}" method="post">
		<p>
			<select class="form-select" name="selectLine"
				onchange="updateLastDone(event)">
				<option th:each="l : ${habits}" th:value=${l.id}
					th:text="${l.name}" th:selected ="(${habitId} == ${l.id})"></option>
			</select>
		</p>
	</form>
	
	<div class="table-responsive" th:unless="${#lists.isEmpty(lastdonehabitentries)}">
		<table class="table table-striped table-hover">
			<thead class="table-dark">
				<tr>
					<td>ID</td>
					<td>last done</td>
					<td>difference</td>
				</tr>
			</thead>
			<tbody>
				<tr th:each="e : ${lastdonehabitentries}">
					<td th:text="${e.id}"></td>
					<td th:text="${#temporals.format(e.date, 'dd.MM.yyyy HH:mm')}"></td>
					<td th:text="${e.difference}"></td>
				</tr>
			</tbody>
		</table>
	</div>
	<h2 class="mt-5">Add Habit Entry</h2>
    <form action="#" th:action="@{/last-done-habit-entries?id=__${habit.id}__}" th:object="${habitentry}" class="mb-5" method="post">
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="title" class="form-label">Habit:</label>
                <input type="text" th:value="${habitentry.habit.name}" class="form-control" disabled>
            </div>
            <div class="col-md-6 mb-3">
                <label for="place" class="form-label">Last Done:</label>
                <input type="datetime-local" th:field="*{lastDone}" class="form-control">
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Add Habit Entry</button>
    </form>
	<a href="/habit-management" class="btn btn-secondary">Back to Dashboard</a>
<script>
function updateLastDone(event) {
	var searchParams = new URLSearchParams(window.location.search);
	searchParams.set("id", event.target.value);
	window.location.search = searchParams.toString();
}
</script>
</body>
</html>
